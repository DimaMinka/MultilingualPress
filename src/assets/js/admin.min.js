!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}var f=a("./common/utils"),g=e(f),h=a("./admin/core/functions"),i=e(h),j=a("./admin/core/common"),k=a("./admin/core/Controller"),l=d(k),m=a("./admin/core/EventManager"),n=a("./admin/core/Model"),o=d(n),p=a("./admin/nav-menus/NavMenus"),q=d(p),r=a("./admin/network/AddNewSite"),s=d(r),t=a("./admin/post-translation/CopyPost"),u=d(t),v=a("./admin/post-translation/RelationshipControl"),w=d(v),x=a("./admin/post-translation/RemotePostSearch"),y=d(x),z=a("./admin/term-translation/TermTranslator"),A=d(z),B=a("./admin/user-settings/UserBackEndLanguage"),C=d(B),D=window.ajaxurl,E={controller:new l["default"],Functions:i,toggler:new j.Toggler({el:"body",events:{"click .mlp-click-toggler":"toggleElement"}}),Util:g},F=E.controller,G=E.toggler,H=void 0;G.initializeStateTogglers(),H=i.getSettings(q["default"]),F.registerModule("nav-menus.php",q["default"],{el:"#"+H.metaBoxID,events:{"click #submit-mlp-language":"sendRequest"},model:new o["default"]({urlRoot:D}),moduleSettings:H}),F.registerModule("network/site-new.php",s["default"],{el:"#wpbody-content form",events:{"change #site-language":"adaptLanguage","change #mlp-base-site-id":"togglePluginsRow"}}),F.registerModule(["post.php","post-new.php"],u["default"],{el:"#post-body",EventManager:m.EventManager,events:{"click .mlp-copy-post-button":"copyPostData"},model:new o["default"]({urlRoot:D}),moduleSettings:i.getSettings(u["default"])}),F.registerModule(["post.php","post-new.php"],w["default"],{el:"body",EventManager:m.EventManager,events:{"change .mlp-rc-actions input":"updateUnsavedRelationships","click #publish":"confirmUnsavedRelationships","click .mlp-save-relationship-button":"saveRelationship"},moduleSettings:i.getSettings(w["default"]),Util:g},function(a){return a.initializeEventHandlers()}),F.registerModule(["post.php","post-new.php"],y["default"],{el:"body",events:{"keydown .mlp-search-field":"preventFormSubmission","keyup .mlp-search-field":"reactToInput"},model:new o["default"]({urlRoot:D}),moduleSettings:i.getSettings(y["default"])},function(a){return a.initializeResults()}),F.registerModule("edit-tags.php",A["default"],{el:"#mlp-term-translations",events:{"change select":"propagateSelectedTerm"}}),F.registerModule("options-general.php",C["default"],{el:"#WPLANG",moduleSettings:i.getSettings(C["default"])},function(a){return a.updateSiteLanguage()}),jQuery(F.initialize),window.MultilingualPressAdmin=E},{"./admin/core/Controller":2,"./admin/core/EventManager":3,"./admin/core/Model":4,"./admin/core/common":6,"./admin/core/functions":7,"./admin/nav-menus/NavMenus":8,"./admin/network/AddNewSite":9,"./admin/post-translation/CopyPost":10,"./admin/post-translation/RelationshipControl":11,"./admin/post-translation/RemotePostSearch":12,"./admin/term-translation/TermTranslator":13,"./admin/user-settings/UserBackEndLanguage":14,"./common/utils":15}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}c.__esModule=!0;var g=a("./functions"),h=e(g),i=a("./Router"),j=d(i),k=window.jQuery,l=window._,m=h.getSettings("mlpSettings"),n={},o={},p=new j["default"],q=function(a,b){o[b]||(o[b]=[]),o[b].push(a)},r=function(){k.each(o,function(a,b){p.route(a,a,function(){k.each(b,function(a,b){var c=b.Constructor,d=new c(b.options);n[c.name]=d,b.callback&&b.callback(d)})})})},s=function(){return Backbone.History.started?!1:(Backbone.history.start({root:m.urlRoot,pushState:!0,hashChange:!1}),!0)},t=function(){function a(){f(this,a),this.modules=n}return a.prototype.registerModule=function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],d=arguments.length<=3||void 0===arguments[3]?null:arguments[3],e={Constructor:b,options:c,callback:d};k.each(l.isArray(a)?a:[a],function(a,b){q(e,b)})},a.prototype.initialize=function(){r(),s()},a}();c["default"]=t},{"./Router":5,"./functions":7}],3:[function(a,b,c){"use strict";c.__esModule=!0;c.EventManager=window._.extend({},Backbone.Events)},{}],4:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var g=function(a){function b(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];d(this,b);var f=e(this,a.call(this,c));return f.urlRoot=c.urlRoot,f}return f(b,a),b}(Backbone.Model);c["default"]=g},{}],5:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var g=function(a){function b(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return d(this,b),e(this,a.call(this,c))}return f(b,a),b}(Backbone.Router);c["default"]=g},{}],6:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var g=window.jQuery;c.Toggler=function(a){function b(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return d(this,b),e(this,a.call(this,c))}return f(b,a),b.prototype.initializeStateTogglers=function(){var a=this;g(".mlp-state-toggler").each(function(b,c){var d=g(c);g('[name="'+d.attr("name")+'"]').on("change",{$toggler:d},a.toggleElementIfChecked)})},b.prototype.toggleElement=function(a){var b=g(a.target).data("toggle-target");b&&g(b).toggle()},b.prototype.toggleElementIfChecked=function(a){var b=a.data.$toggler,c=b.data("toggle-target");c&&g(c).toggle(b.is(":checked"))},b}(Backbone.View)},{}],7:[function(a,b,c){"use strict";c.__esModule=!0;var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},e=function(a){switch("undefined"==typeof a?"undefined":d(a)){case"function":return a.name;case"string":return a;case"object":return a.constructor.name}return""};c.getSettings=function(a){return a=e(a),"undefined"!=typeof window["mlp"+a+"Settings"]?window["mlp"+a+"Settings"]:"undefined"!=typeof window[a]?window[a]:{}}},{}],8:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var g=window.jQuery,h=function(a){function b(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];d(this,b);var f=e(this,a.call(this,c));return f.$languages=f.$el.find('li [type="checkbox"]'),f.$menu=g("#menu"),f.$menuToEdit=g("#menu-to-edit"),f.$spinner=f.$el.find(".spinner"),f.$submit=f.$el.find("#submit-mlp-language"),f.model=c.model,f.listenTo(f.model,"change",f.render),f.moduleSettings=c.moduleSettings,f}return f(b,a),b.prototype.sendRequest=function(a){var b={action:this.moduleSettings.action,menu:this.$menu.val(),mlp_sites:this.getSites()};b[this.moduleSettings.nonceName]=this.moduleSettings.nonce,a.preventDefault(),this.$submit.prop("disabled",!0),this.$spinner.addClass("is-active"),this.model.fetch({data:b,processData:!0})},b.prototype.getSites=function(){var a=[];return this.$languages.filter(":checked").each(function(b,c){a.push(Number(g(c).val()||0))}),a},b.prototype.render=function(){this.model.get("success")&&this.$menuToEdit.append(this.model.get("data")),this.$languages.prop("checked",!1),this.$spinner.removeClass("is-active"),this.$submit.prop("disabled",!1)},b}(Backbone.View);c["default"]=h},{}],9:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var g=window.jQuery,h=function(a){function b(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];d(this,b);var f=e(this,a.call(this,c));return f.template=_.template(g("#mlp-add-new-site-template").html()||""),f.$el.find(".submit").before(f.template()),f.$language=g("#mlp-site-language"),f.$pluginsRow=g("#mlp-activate-plugins").closest("tr"),f}return f(b,a),b.prototype.adaptLanguage=function(a){var b=this.getLanguage(g(a.target));this.$language.find('[value="'+b+'"]').length&&this.$language.val(b)},b.prototype.getLanguage=function(a){var b=a.val();return b?b.replace("_","-"):"en-US"},b.prototype.togglePluginsRow=function(a){this.$pluginsRow.toggle(0<g(a.target).val())},b}(Backbone.View);c["default"]=h},{}],10:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var g=window.jQuery,h=window,i=h._,j=function(a){function b(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];d(this,b);var f=e(this,a.call(this,c));return f.$content=g("#content"),f.$excerpt=g("#excerpt"),f.$title=g("#title"),f.EventManager=c.EventManager,f.model=c.model,f.listenTo(f.model,"change",f.updatePostData),f.moduleSettings=c.moduleSettings,f.postID=Number(g("#post_ID").val()),f}return f(b,a),b.prototype.copyPostData=function(a){var b=this.getRemoteSiteID(g(a.target)),c={};a.preventDefault(),g("#mlp-translation-data-"+b+"-copied-post").val(1),this.EventManager.trigger("CopyPost:copyPostData",c,this.moduleSettings.siteID,this.postID,b),c=i.extend(c,{action:this.moduleSettings.action,current_post_id:this.postID,remote_site_id:b,title:this.getTitle(),slug:this.getSlug(),content:this.getContent(),excerpt:this.getExcerpt()}),this.model.fetch({data:c,processData:!0})},b.prototype.getRemoteSiteID=function(a){return a.data("site-id")||0},b.prototype.getTitle=function(){return this.$title.val()||""},b.prototype.getSlug=function(){return g("#editable-post-name-full").text()||""},b.prototype.getContent=function(){return this.$content.val()||""},b.prototype.getExcerpt=function(){return this.$excerpt.val()||""},b.prototype.updatePostData=function(){var a=void 0,b=void 0;return this.model.get("success")?(a=this.model.get("data"),b="mlp-translation-data-"+a.siteID+"-",g("#"+b+"title").val(a.title),g("#"+b+"name").val(a.slug),this.setTinyMCEContent(b+"content",a.content),g("#"+b+"content").val(a.content),g("#"+b+"excerpt").val(a.excerpt),this.EventManager.trigger("CopyPost:updatePostData",a),!0):!1},b.prototype.setTinyMCEContent=function(a,b){var c=void 0;return"undefined"==typeof window.tinyMCE?!1:(c=window.tinyMCE.get(a))?(c.setContent(b),!0):!1},b}(Backbone.View);c["default"]=j},{}],11:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var g=window.jQuery,h=function(a){function b(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];d(this,b);var f=e(this,a.call(this,c));return f.EventManager=c.EventManager,f.moduleSettings=c.moduleSettings,f.unsavedRelationships=[],f.Util=c.util,f}return f(b,a),b.prototype.initializeEventHandlers=function(){this.EventManager.on({"RelationshipControl:connectExistingPost":this.connectExistingPost,"RelationshipControl:connectNewPost":this.connectNewPost,"RelationshipControl:disconnectPost":this.disconnectPost},this)},b.prototype.updateUnsavedRelationships=function(a){var b=g(a.target),c=b.closest(".mlp-translation-meta-box"),d=c.find(".mlp-save-relationship-button"),e=this.findMetaBox(c);"stay"===b.val()?(d.prop("disabled","disabled"),-1!==e&&this.unsavedRelationships.splice(e,1)):-1===e&&(this.unsavedRelationships.push(c),d.removeAttr("disabled"))},b.prototype.findMetaBox=function(a){return g.each(this.unsavedRelationships,function(b,c){return c===a?b:void 0}),-1},b.prototype.confirmUnsavedRelationships=function(a){this.unsavedRelationships.length&&!window.confirm(this.moduleSettings.L10n.unsavedRelationships)&&a.preventDefault()},b.prototype.saveRelationship=function(a){var b=g(a.target),c=b.data("remote-site-id"),d=g('input[name="mlp-rc-action['+c+']"]:checked').val(),e=this.getEventName(d);"stay"!==d&&(b.prop("disabled","disabled"),this.EventManager.trigger("RelationshipControl:"+e,{action:"mlp_rc_"+d,remote_site_id:c,remote_post_id:b.data("remote-post-id"),source_site_id:b.data("source-site-id"),source_post_id:b.data("source-post-id")},e))},b.prototype.getEventName=function(a){switch(a){case"search":return"connectExistingPost";case"new":return"connectNewPost";case"disconnect":return"disconnectPost";default:return""}},b.prototype.connectNewPost=function(a){a.new_post_title=g('input[name="post_title"]').val(),this.sendRequest(a)},b.prototype.disconnectPost=function(a){this.sendRequest(a)},b.prototype.connectExistingPost=function(a){var b=g('input[name="mlp_add_post['+a.remote_site_id+']"]:checked').val()||0;return b?(a.new_post_id=Number(b),this.sendRequest(a),!0):(window.alert(this.moduleSettings.L10n.noPostSelected),!1)},b.prototype.sendRequest=function(a){g.ajax({type:"POST",url:window.ajaxurl,data:a,success:this.Util.reloadLocation,async:!1})},b}(Backbone.View);c["default"]=h},{}],12:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var g=window.jQuery,h=function(a){function b(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];d(this,b);var f=e(this,a.call(this,c));return f.defaultResults=[],f.resultsContainers=[],f.moduleSettings=c.moduleSettings,f.searchThreshold=parseInt(f.moduleSettings.searchThreshold,10),f.model=c.model,f.listenTo(f.model,"change",f.render),f}return f(b,a),b.prototype.initializeResults=function(){var a=this;g(".mlp-search-field").each(function(b,c){var d=g(c),e=g("#"+d.data("results-container-id")),f=d.data("remote-site-id");a.defaultResults[f]=e.html(),a.resultsContainers[f]=e})},b.prototype.preventFormSubmission=function(a){13===a.which&&a.preventDefault()},b.prototype.reactToInput=function(a){var b=this,c=g(a.target),d=g.trim(c.val()||""),e=void 0;d!==c.data("value")&&(clearTimeout(this.reactToInputTimer),c.data("value",d),e=c.data("remote-site-id"),""===d?this.resultsContainers[e].html(this.defaultResults[e]):d.length>=this.searchThreshold&&(this.reactToInputTimer=setTimeout(function(){b.model.fetch({data:{action:"mlp_rc_remote_post_search",remote_site_id:e,remote_post_id:c.data("remote-post-id"),source_site_id:c.data("source-site-id"),source_post_id:c.data("source-post-id"),s:d},processData:!0})},400)))},b.prototype.render=function(){var a=void 0;return this.model.get("success")?(a=this.model.get("data"),this.resultsContainers[a.remoteSiteID].html(a.html),!0):!1},b}(Backbone.View);c["default"]=h},{}],13:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var g=window.jQuery,h=function(a){function b(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];d(this,b);var f=e(this,a.call(this,c));return f.$selects=f.$el.find("select"),f.isPropagating=!1,f}return f(b,a),b.prototype.propagateSelectedTerm=function(a){var b=this,c=void 0,d=void 0;this.isPropagating||(this.isPropagating=!0,c=g(a.target),d=this.getSelectedRelation(c),""!==d&&this.$selects.not(c).each(function(a,c){b.selectTerm(g(c),d)}),this.isPropagating=!1)},b.prototype.getSelectedRelation=function(a){return a.find("option:selected").data("relation")||""},b.prototype.selectTerm=function(a,b){var c=a.find('option[data-relation="'+b+'"]');c.length?a.val(c.val()):this.getSelectedRelation(a)&&a.val(a.find("option").first().val())},b}(Backbone.View);c["default"]=h},{}],14:[function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}c.__esModule=!0;var g=function(a){function b(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];d(this,b);var f=e(this,a.call(this,c));return f.moduleSettings=c.moduleSettings,f}return f(b,a),b.prototype.updateSiteLanguage=function(){this.$el.val(this.moduleSettings.locale)},b}(Backbone.View);c["default"]=g},{}],15:[function(a,b,c){"use strict";c.__esModule=!0;c.addEventListener=function(a,b,c){a.addEventListener?a.addEventListener(b,c):a.attachEvent("on"+b,function(){c.call(a)})},c.reloadLocation=function(){window.location.reload(!0)},c.setLocation=function(a){window.location.href=a}},{}]},{},[1]);